/*
Fathom.js v1.0
Copyright 2011, Mark Dalgleish

This content is released under the MIT License
github.com/markdalgleish/fathom/blob/master/MIT-LICENSE.txt
*/
(function(a,b,c){var d=function(a,b){this.container=a,this.options=b;return this.init()},e=a(b),f=a(document);d.prototype={defaults:{displayMode:"single",slideTagName:"div",slideClass:"slide",activeClass:"activeslide",inactiveClass:"inactiveslide",margin:100,onScrollInterval:300,scrollLength:600,_autoStyles:!0,onActivateSlide:c,onDeactivateSlide:c},init:function(){var b=this;this.config=a.extend({},this.defaults,this.options),this.$container=a(this.container),this.$slides=this.$container.find(this.config.slideTagName+(this.config.slideClass?"."+this.config.slideClass:"")),this.$firstSlide=this.$slides.filter(":first"),this.$lastSlide=this.$slides.filter(":last"),this.$activeSlide=this.activateSlide(this.$firstSlide),this._setStyles()._setClasses()._setMargins()._setupEvents()._setupScrollHandler();return this},nextSlide:function(){var a=this.$activeSlide.next();a.length===1&&a.hasClass(this.config.slideClass)&&this.scrollToSlide(a);return a},prevSlide:function(){var a=this.$activeSlide.prev();a.length===1&&this.scrollToSlide(a);return a},scrollToSlide:function(b){var c=this;this.isAutoScrolling=!0,a("html,body").stop().animate({scrollLeft:b.position().left-(e.width()-b.innerWidth())/2},c.config.scrollLength,function(){c.isAutoScrolling=!1});return this.activateSlide(b)},activateSlide:function(a){var b=a.get(0),d;if(this.$activeSlide!==c){d=this.$activeSlide.get(0);if(d===b)return a;this.$activeSlide.removeClass(this.config.activeClass).addClass(this.config.inactiveClass).trigger("deactivateslide.fathom"),typeof this.config.onDeactivateSlide=="function"&&this.config.onDeactivateSlide.call(d)}a.removeClass(this.config.inactiveClass).addClass(this.config.activeClass),this.$activeSlide=a,a.trigger("activateslide.fathom"),typeof this.config.onActivateSlide=="function"&&this.config.onActivateSlide.call(b);return a},_setupEvents:function(){var b=this;this.$container.delegate(this.config.slideTagName+"."+this.config.inactiveClass,"click",function(c){c.preventDefault(),b.scrollToSlide(a(this))}),f.keydown(function(a){var c=a.which;c===39||c===32?(a.preventDefault(),b.nextSlide()):c===37&&(a.preventDefault(),b.prevSlide())}),e.resize(function(){b._setMargins()});return this},_setStyles:function(){this.config._autoStyles&&(a("body").width(99999),this.$clearFloats=this.$container.append('<div style="clear:left"></div>'),this.$container.css("float","left"),this.$slides.css("float","left"));return this},_setClasses:function(){this.$slides.addClass(this.config.inactiveClass),this.$activeSlide.removeClass(this.config.inactiveClass).addClass(this.config.inactiveClass);return this},_setMargins:function(){var k=Math.ceil,b=this.config.displayMode,c=e.width(),d=k((e.height()-this.$firstSlide.innerHeight())/2),f=k((c-this.$firstSlide.innerWidth())/2),g=k((c-this.$lastSlide.innerWidth())/2),h=k(c/25);this.$container.css("margin-top",d),b==="single"?this.$slides.css("margin-right",f-h):b==="multi"&&this.$slides.css("margin-right",this.config.margin),this.$firstSlide.css("margin-left",f),this.$lastSlide.css("margin-right",g),a("html,body").width(this.$container.outerWidth());return this},_setupScrollHandler:function(){function g(){b.midpoint={x:e.width()/2,y:e.height()/2}}var b=this,d=b.config.slideTagName+(b.config.slideClass?"."+b.config.slideClass:""),f;b.scrolling=!1,g(),setInterval(function(){b.scrolling&&(b.isAutoScrolling===!1||b.isAutoScrolling===c)&&(b.scrolling=!1,e.scrollLeft()===0?b.activateSlide(b.$firstSlide):(f=a(document.elementFromPoint(b.midpoint.x,b.midpoint.y)),f.is(d)?b.activateSlide(f):f=f.parents(d+":first").each(function(){b.activateSlide(a(this))})))},b.config.onScrollInterval),e.scroll(function(){b.scrolling=!0}).resize(function(){g()});return this}},a.fn.fathom=function(a){new d(this,a);return this},d.defaults=d.prototype.defaults,d.setDefaults=function(b){a.extend(d.defaults,b)},b.Fathom=d})(jQuery,window);